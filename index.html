<!DOCTYPE html>
<html>
<head>
    <title>CLP(Z) Solver</title>
    <script src="https://tau-prolog.org/tau-prolog.js"></script>
    <script src="http://localhost:8080/pengine/pengines.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


</head>
<body>
    <h1>CLP(Z) Solver</h1>
    <label for="sum">Suma:</label>
    <input type="number" id="sum" value="12"><br>
    <label for="product">Producto:</label>
    <input type="number" id="product" value="32"><br>
    <button onclick="solve()">Resolver</button>
    <div id="result"></div>

    <script>
        console.log('Tau Prolog cargado:', typeof pl !== 'undefined' ? 'Sí' : 'No'); // Verificar Tau Prolog
        const session = pl.create();
        console.log('Sesión creada:', session);

        function solve() {
            console.log('Función solve() ejecutada'); // Depurar clic
            const sum = parseInt(document.getElementById('sum').value);
            const product = parseInt(document.getElementById('product').value);
            console.log('Sum:', sum, 'Product:', product); // Depurar valores
            const params = `dict{sum:${sum}, product:${product}}`;
            console.log('Params:', params); // Depurar consulta

            const pengine = new Pengine({
                server: 'http://localhost:8080/pengine',
                application: 'clp',
                onsuccess: function() {
                    console.log('Respuesta completa:', this.data); // Depurar respuesta
                    if (this.data && this.data[0] && this.data[0].Solution) {
                        const solution = this.data[0].Solution;
                        document.getElementById('result').innerText = 
                            `Solución: X = ${solution[0]}, Y = ${solution[1]}`;
                    } else {
                        document.getElementById('result').innerText = 
                            'Error: No se encontró solución válida';
                    }
                },
                onerror: function() {
                    console.log('Error:', this.error); // Depurar error
                    document.getElementById('result').innerText = 'Error: ' + this.error;
                },
                oncreate: function() {
                    console.log('Pengine creado:', this); // Depurar creación
                }
            });
            pengine.ask(`solve(${params}, Solution).`);
            console.log('Consulta enviada');
        }
    </script>
</body>
</html>